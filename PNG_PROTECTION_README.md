# Захист PNG зображень від автоматичної конвертації

## Опис
Цей код захищає PNG зображення від автоматичної конвертації в JPG та стиснення, що може пошкодити альфа-канал (прозорість).

## Аналог WordPress коду
Оригінальний WordPress код:
```php
/**
 * Забороняє WordPress автоматично конвертувати PNG в JPG
 * і стискати прозорі зображення.
 */
add_filter( 'wp_editor_set_quality', function( $quality, $mime_type ) {
    if ( 'image/png' === $mime_type ) {
        // Повертаємо 100, щоб уникнути стиснення, яке може пошкодити альфа-канал
        return 100;
    }
    return $quality;
}, 10, 2 );

// Також вимикаємо створення великих копій, що іноді викликає конвертацію
add_filter( 'big_image_size_threshold', '__return_false' );
```

## Django реалізація

### 1. Налаштування в settings.py
- `PNG_PROTECTION` - налаштування захисту PNG
- `FILE_UPLOAD_MAX_MEMORY_SIZE` - збільшений ліміт для PNG файлів
- `mimetypes` - правильна реєстрація MIME типів

### 2. Middleware (PNGProtectionMiddleware)
- Автоматично додає правильні заголовки для PNG файлів
- Забезпечує кешування та правильний Content-Type

### 3. Функції захисту
- `protect_png_images()` - захищає PNG від стиснення
- `validate_image_format()` - валідує формат зображення
- `process_uploaded_image()` - обробляє завантажені зображення

## Переваги
- ✅ Зберігає прозорість PNG зображень
- ✅ Запобігає автоматичній конвертації в JPG
- ✅ Забороняє стиснення, що може пошкодити альфа-канал
- ✅ Забезпечує максимальну якість (100%)
- ✅ Автоматично застосовується до всіх PNG файлів

## Використання
Код автоматично активується при запуску Django сервера. Всі PNG зображення будуть захищені від конвертації та стиснення.

## Файли
- `mysite/settings.py` - основні налаштування
- `mysite/image_protection.py` - функції захисту та middleware
- `PNG_PROTECTION_README.md` - ця документація
